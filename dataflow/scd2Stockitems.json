{
	"name": "scd2Stockitems",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "WarehouseStockitemsODS",
						"type": "DatasetReference"
					},
					"name": "WarehouseStockitems"
				},
				{
					"dataset": {
						"referenceName": "SalesOrderINTEGRATION",
						"type": "DatasetReference"
					},
					"name": "SalesOrderTable"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "SalesOrderINTEGRATION",
						"type": "DatasetReference"
					},
					"name": "sink1"
				},
				{
					"dataset": {
						"referenceName": "SalesOrderINTEGRATION",
						"type": "DatasetReference"
					},
					"name": "sink2"
				}
			],
			"transformations": [
				{
					"name": "AddingIsActive"
				},
				{
					"name": "SurrogateKey1"
				},
				{
					"name": "Select1"
				},
				{
					"name": "Lookup1"
				},
				{
					"name": "ExistingRows"
				},
				{
					"name": "Select2"
				},
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "AlterRow1"
				}
			],
			"script": "source(output(\n\t\tStockItemID as integer,\n\t\tStockItemName as string,\n\t\tSupplierID as integer,\n\t\tColorID as integer,\n\t\tUnitPackageID as integer,\n\t\tOuterPackageID as integer,\n\t\tBrand as string,\n\t\tSize as string,\n\t\tLeadTimeDays as integer,\n\t\tQuantityPerOuter as integer,\n\t\tIsChillerStock as boolean,\n\t\tBarcode as string,\n\t\tTaxRate as decimal(18,3),\n\t\tUnitPrice as decimal(18,2),\n\t\tRecommendedRetailPrice as decimal(18,2),\n\t\tTypicalWeightPerUnit as decimal(18,3),\n\t\tMarketingComments as string,\n\t\tInternalComments as string,\n\t\tPhoto as binary,\n\t\tCustomFields as string,\n\t\tTags as string,\n\t\tSearchDetails as string,\n\t\tLastEditedBy as integer,\n\t\tValidFrom as timestamp,\n\t\tValidTo as timestamp\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: true,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> WarehouseStockitems\nsource(output(\n\t\tOrderID as integer,\n\t\tCustomerID as integer,\n\t\tSalespersonPersonID as integer,\n\t\tPickedByPersonID as integer,\n\t\tContactPersonID as integer,\n\t\tBackorderOrderID as integer,\n\t\tOrderDate as date,\n\t\tExpectedDeliveryDate as date,\n\t\tCustomerPurchaseOrderNumber as string,\n\t\tIsUndersupplyBackordered as boolean,\n\t\tComments as string,\n\t\tDeliveryInstructions as string,\n\t\tInternalComments as string,\n\t\tPickingCompletedWhen as timestamp,\n\t\tLastEditedBy as integer,\n\t\tLastEditedWhen as timestamp,\n\t\tIsActive as integer,\n\t\tSurrogateKey as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> SalesOrderTable\nWarehouseStockitems derive(IsActive = 1) ~> AddingIsActive\nAddingIsActive keyGenerate(output(SurrogateKey as long),\n\tstartAt: 1L) ~> SurrogateKey1\nSalesOrderTable select(mapColumn(\n\t\tSQL_OrderID = OrderID,\n\t\tSQL_CustomerID = CustomerID,\n\t\tSQL_SalespersonPersonID = SalespersonPersonID,\n\t\tSQL_PickedByPersonID = PickedByPersonID,\n\t\tSQL_ContactPersonID = ContactPersonID,\n\t\tSQL_BackorderOrderID = BackorderOrderID,\n\t\tSQL_OrderDate = OrderDate,\n\t\tSQL_ExpectedDeliveryDate = ExpectedDeliveryDate,\n\t\tSQL_CustomerPurchaseOrderNumber = CustomerPurchaseOrderNumber,\n\t\tSQL_IsUndersupplyBackordered = IsUndersupplyBackordered,\n\t\tSQL_Comments = Comments,\n\t\tSQL_DeliveryInstructions = DeliveryInstructions,\n\t\tSQL_InternalComments = InternalComments,\n\t\tSQL_PickingCompletedWhen = PickingCompletedWhen,\n\t\tSQL_LastEditedBy = LastEditedBy,\n\t\tSQL_LastEditedWhen = LastEditedWhen,\n\t\tSQL_IsActive = IsActive,\n\t\tSQL_SurrogateKey = SurrogateKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nWarehouseStockitems, Select1 lookup(OrderID == SQL_OrderID,\n\tmultiple: true,\n\tbroadcast: 'auto')~> Lookup1\nLookup1 filter(!isNull(SQL_OrderID)) ~> ExistingRows\nExistingRows select(mapColumn(\n\t\tSQL_OrderID,\n\t\tSQL_CustomerID,\n\t\tSQL_SalespersonPersonID,\n\t\tSQL_PickedByPersonID,\n\t\tSQL_ContactPersonID,\n\t\tSQL_BackorderOrderID,\n\t\tSQL_OrderDate,\n\t\tSQL_ExpectedDeliveryDate,\n\t\tSQL_CustomerPurchaseOrderNumber,\n\t\tSQL_IsUndersupplyBackordered,\n\t\tSQL_Comments,\n\t\tSQL_DeliveryInstructions,\n\t\tSQL_InternalComments,\n\t\tSQL_PickingCompletedWhen,\n\t\tSQL_LastEditedBy,\n\t\tSQL_LastEditedWhen,\n\t\tSQL_IsActive,\n\t\tSQL_SurrogateKey\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select2\nSelect2 derive(SQL_IsActive = 0) ~> DerivedColumn1\nDerivedColumn1 alterRow(updateIf(1==1)) ~> AlterRow1\nSurrogateKey1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tOrderID as integer,\n\t\tCustomerID as integer,\n\t\tSalespersonPersonID as integer,\n\t\tPickedByPersonID as integer,\n\t\tContactPersonID as integer,\n\t\tBackorderOrderID as integer,\n\t\tOrderDate as date,\n\t\tExpectedDeliveryDate as date,\n\t\tCustomerPurchaseOrderNumber as string,\n\t\tIsUndersupplyBackordered as boolean,\n\t\tComments as string,\n\t\tDeliveryInstructions as string,\n\t\tInternalComments as string,\n\t\tPickingCompletedWhen as timestamp,\n\t\tLastEditedBy as integer,\n\t\tLastEditedWhen as timestamp,\n\t\tIsActive as integer,\n\t\tSurrogateKey as integer\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tOrderID,\n\t\tCustomerID,\n\t\tSalespersonPersonID,\n\t\tPickedByPersonID,\n\t\tContactPersonID,\n\t\tBackorderOrderID,\n\t\tOrderDate,\n\t\tExpectedDeliveryDate,\n\t\tCustomerPurchaseOrderNumber,\n\t\tIsUndersupplyBackordered,\n\t\tComments,\n\t\tDeliveryInstructions,\n\t\tInternalComments,\n\t\tPickingCompletedWhen,\n\t\tLastEditedBy,\n\t\tLastEditedWhen,\n\t\tIsActive,\n\t\tSurrogateKey\n\t)) ~> sink1\nAlterRow1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tOrderID as integer,\n\t\tCustomerID as integer,\n\t\tSalespersonPersonID as integer,\n\t\tPickedByPersonID as integer,\n\t\tContactPersonID as integer,\n\t\tBackorderOrderID as integer,\n\t\tOrderDate as date,\n\t\tExpectedDeliveryDate as date,\n\t\tCustomerPurchaseOrderNumber as string,\n\t\tIsUndersupplyBackordered as boolean,\n\t\tComments as string,\n\t\tDeliveryInstructions as string,\n\t\tInternalComments as string,\n\t\tPickingCompletedWhen as timestamp,\n\t\tLastEditedBy as integer,\n\t\tLastEditedWhen as timestamp,\n\t\tIsActive as integer,\n\t\tSurrogateKey as integer\n\t),\n\tdeletable:false,\n\tinsertable:false,\n\tupdateable:true,\n\tupsertable:false,\n\tkeys:['SurrogateKey'],\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tOrderID = SQL_OrderID,\n\t\tCustomerID = SQL_CustomerID,\n\t\tSalespersonPersonID = SQL_SalespersonPersonID,\n\t\tPickedByPersonID = SQL_PickedByPersonID,\n\t\tContactPersonID = SQL_ContactPersonID,\n\t\tBackorderOrderID = SQL_BackorderOrderID,\n\t\tOrderDate = SQL_OrderDate,\n\t\tExpectedDeliveryDate = SQL_ExpectedDeliveryDate,\n\t\tCustomerPurchaseOrderNumber = SQL_CustomerPurchaseOrderNumber,\n\t\tIsUndersupplyBackordered = SQL_IsUndersupplyBackordered,\n\t\tComments = SQL_Comments,\n\t\tDeliveryInstructions = SQL_DeliveryInstructions,\n\t\tInternalComments = SQL_InternalComments,\n\t\tPickingCompletedWhen = SQL_PickingCompletedWhen,\n\t\tLastEditedBy = SQL_LastEditedBy,\n\t\tLastEditedWhen = SQL_LastEditedWhen,\n\t\tIsActive = SQL_IsActive,\n\t\tSurrogateKey = SQL_SurrogateKey\n\t)) ~> sink2"
		}
	}
}